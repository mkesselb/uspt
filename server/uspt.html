<html>
	<meta charset="utf-8">
	<title>uspt prototype</title>
	<script src="/socket.io/socket.io.js"></script>
	<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
	<body>
		<h1>uspt prototype</h1>
		
		<h3>Participate in personality study:</h3>
		
		<form id="formLogin">
			First name: <br>
			<input type="text" id="fname" maxlength="20"> <br> 
			<br>
			
			Last name: <br>
			<input type="text" id="lname" maxlength="20"> <br>
			<br>
			
			Sex: <br>
			<input type="text" id="sex" maxlength="1"> (Format: m / f)<br>
			<br>
			
			Birthday: <br>
			<input type="text" id="bday" maxlength="8"> (Format: ddmmyyyy)<br>
			<br>
			
			Institution: <br>
			<input type="text" id="inst" maxlength="20"> <br>
			<br>
			
			Survey Key: <br>
			<input type="text" id="skey" maxlength="20"> <br>
			<br>
			
			<button type="button" id="button-login">login</button>
		</form>
		
		<div id="survey">
			<div id="hashtoken"></div>
			<br>
			<form id="formSurvey">
				Factor1: <br>
				<input type="number" id="f1" min="-5" max="5" step="1"> <br>
				<br>
				
				Factor2: <br>
				<input type="number" id="f2" min="-5" max="5" step="1"> <br>
				<br>
				
				<button type="button" id="button-survey">complete survey</button>
			</form>
		</div>
		
		<div id="completion"></div>
		
		<p>uspt - university students personality testing</p>
		
		<script>
		$(document).ready(function(){
			var socket = io.connect();
			
			$('#formLogin').show();
			$('#survey').hide();
			$('#completion').hide();
			
			$('#button-login').click(function(){
				//write login data to server
				socket.emit('login', 
				{fname: $('#fname').val(),
				lname: $('#lname').val(),
				sex: $('#sex').val(),
				birthday: $('#bday').val(),
				institution: $('#inst').val(),
				survey_key: $('#skey').val()});
			});
			
			socket.on('login-success', function(data){
				$('#formLogin').hide();
				$('#survey').show();
				$('#hashtoken').append('your hash token:' + data.hash);
			});
			
			$('#button-survey').click(function(){
				//write survey data to server
				socket.emit('survey', 
				{f1: $('#f1').val(),
				f2: $('#f2').val()});
			});
			
			socket.on('survey-success', function(){
				$('#survey').hide();
				$('#completion').show();
				$('#completion').append('thank you for completing the survey. you may close the window now');
			});
		});
		</script>
	</body>
</html>